# recycleledger_data_preprocessing

행정안전부 지방행정인허가데이터애 식당관련 32개의 데이터 사용(달마다 다운로드해야함)

## 전처리 단계

1. 식당관련 데이터 32개 파일 cat으로 합쳐서 re.csv파일 생성
2. re.csv읽고 중복제거
3. 식당관련없이 문자열로 되어있는 이상치값이 있어서 제거
4. 같은 가게가 여러개일때 가장 최근 자료 내용으로 반영하기위해 인허가 최근순으로 정렬
5. 같은 가게가 여러개일때 상태는 다르기때문에 중복제거를 2번에서 했지만 삭제되지않아 좌표정보 x와 소재지전체주소가 같은 경우도 중복제거를 해서 최대한 같은가게 정보 줄임(조금 더 빠르게 탐색을 하기위해서, 이래도 같은가게에 대해 주소를 다르게 적은 경우가 있었는데 그런경우에 인허가 최근순으로 정렬했기때문에 가장 최근꺼 반영)
6. 좌표정보에 '한식'이라는 문자열 값이 들어간 행있어서 삭제
7. 빈칸을 아무값으로 채우려다보니까 좌표정보 실수값이 정수로 바껴서 소재지,도로명주소,사업장명의 빈칸은 empty문자열로 채우고 좌표정보 빈칸은 0.0으로 채움
8. 좌표정보(x),(y)가 TM좌표계로 되어있어서 WGS84 좌표계로(위경도꼴) 변환하기위해 pyproj, numpy사용
9. 전체식당정보 dataframe에 위경도 칼럼 추가(좌표정보(x),(y)가 0일때도 변환하면 위경도값이나와서 추후에 조건문으로 거름)
--------- 위는 전체 음식점 전처리 test.csv로 저장(엑셀은 크기초과로 저장안됨) -----------
--------- 아래부터 이 레포에 올라온 코드 정리전 ----------
10. xlsx불러옴
11. 위도, 경도, 좌표정보(x),  좌표정보(y) 칼럼 일단 none으로 추가해줌
12. 음식점 데이터는 서울특별시 ~이런꼴인데 xlsx파일은 서울 ~구이런꼴이라 가장앞 지역부분 땜
13. 음식점데이터와 xlsx데이터 비교를 할때 xlsx문자열이 들었는가를 위해 str.contains()를 사용했는데 정규표현식때문에 괄호가 있으면 의미가 바껴서 주소에 괄호부분도 삭제함
14. 주소가 도로명인곳도 그냥 ~동 이런값도 있어서 소재지전체주소나 도로명전체주소 둘중하나라도 xlsx주소값을 포함하는가 라는 조건을 만족하며 사업장명이 같은가라는 조건으로 xlsx데이터를 음식점데이터에서 찾음
15. 사업자명도 괄호가 있는경우가있어서 괄호가있는경우는 가게명이 같은지 조건을 주고 없는경우는 상호명을 포함하는 식당이름이 있는가로 진행(식당명이 조금씩 다른경우가 있어서)
16. 음식점데이터에 주소와 상호명을 가진 행이있는경우 상세영업상태명 칼럼을 통해 영업상태를 확인하고 영업상태인경우는 1, 아닌경우는 2를 부여함
17. 영업상태인경우 url도 추가해주려했지만 네이버에는 위경도값을 알아도 좌표정보를 알아도 링크로 만들어서 링크에 접속해도 해당 링크가 그냥 네이버 지도 검색안한상태만 보여줌, 구글지도에는 위경도로 위치는 띄워주지만 해당 위경도만 잡을뿐 가게관련한 정보가 하나도 뜨지않고 지도위치만 나옴
18. 그래서 url을 부여하지는 않고 음식점이 영업상태인경우 좌표정보가 0(널값)이 아니었던경우 좌표정보와 위경도 정보를 같이 저장해줌(이값을 저장해주기 위해 11번에서 none으로 채운 칼럼을 생성해둔것)
19. 인덱스 정리하고 마무리
--------- 위 단계들을 정리하고 엑셀 시트개수별 + url 추가한 코드가 이 레포 -----------
20. 엑셀 파일 입력
21. 시트 개수 입력
22. 네이버 검색 url 제공


// 영업정보에 1이나 2말고 널값이 있을수있는데 그 널값은 xlsx에서 주소와 가게정보를 음식점데이터에서 검색해봤지만 나오지않은경우(오타거나 정보가 없었던경우)<br/>
// 제거는 중복제거만 했고 웬만하면 빈거라도 행자체를 삭제하지않음(혹시나 필요한 자료일수있어서)<br/>
// 데이터 2300개였지만 3시간정도 걸린듯( xlsx파일이 음식점데이터와 같은꼴이라면 조건문을 줄여 시간이 좀더 빨라질 수 는 있을듯)<br/>
// 영업중이지만 원래 좌표정보가 음식점 데이터에서 널값이었던경우는 위경도값이 없을 수 있음<br/>

https://www.localdata.go.kr/main.do
